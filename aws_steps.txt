
Local Spin up the instance
==========================
cd ~/Documents

source ~/.bash_profile 

aws --region=eu-west-1 ec2 describe-spot-price-history --instance-types  p3.2xlarge --start-time=$(date +%s) --product-descriptions="Linux/UNIX" --query 'SpotPriceHistory[*].{az:AvailabilityZone, price:SpotPrice}' --availability-zone eu-west-1a

aws ec2 run-instances --image-id ami-0f5ebd171c26abc61 --instance-type p3.2xlarge --security-group-ids sg-09ceb02f960da25fa  --associate-public-ip-address --instance-market-options file://spot-options.json --key-name darraghaws  --placement AvailabilityZone=eu-west-1a

aws ec2 describe-instances | grep ec2

# Manually attach the volume
ssh -i "darraghaws.pem" ubuntu@ec2-46-137-24-16.eu-west-1.compute.amazonaws.com


Remote 
===================
source activate pytorch_latest_p36

# Mount the volume
sudo mkdir /data
sudo mount /dev/xvdf /data
sudo cp /etc/fstab /etc/fstab.orig
sudo lsblk -o +UUID

# Add for restart
sudo vim /etc/fstab
# Add a line like 
# UUID=aebf131c-6957-451e-8d34-ec978d9581ae  /data  xfs  defaults,nofail  0  2

# Installs
sudo apt-get update -y
sudo apt-get install -y libturbojpeg
git config --global credential.helper store # so we only need to enter credentials once
cd /data/rsnastr
pip install -r requirements.txt 
